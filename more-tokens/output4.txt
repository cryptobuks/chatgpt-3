Jimmy Cui: So clever Mark's standing. The ingress rule is allowing the access from outside of the parameter.
01:05:00
Presenter-B: Right. Correct.
Jimmy Cui: You have to pull the data. Okay? So the egress is allowing the data to come outside of the
Presenter-B: egress allows you to Allow the data movement, from inside of your perimeter, to the outside of your perimeter.
Jimmy Cui: Yeah, yeah,…
Jimmy Cui: that's it. Your crush.
Presenter-B: Yeah, and…
Presenter-B: ingress like you said, allowing outside to come into your perimeter, to talk to your APIs in your perimeter.
Jimmy Cui: So when we allow the ingress, then we also allow the data you…
Presenter-B:  Great.
Jimmy Cui: outside, right? I mean from the parameter to move outside of the parameter.
Presenter-B:  Well, you don't have to, but you could do that, you know, when you create an ingress role, it's it's a directional access, it's not bidirectional. So you'll have to have the outside the reverse way as well added as any response. Yeah.
Jimmy Cui: That's a similar, like the new the network denied allowed by default is by directional. Cool.
Presenter-B: Correct. Yeah. With bridges. You can actually have it by directional or, you know, goes both ways. Ingress, and ingress rules are definitely a lot more granular. Anyway, I'm gonna delete this parameter and…
Jimmy Cui:  Mm-hmm.
Presenter-B: I'll show you how to do this real quick through Terraform. because there's a couple of gachas, I ran into So terraform there is a VPC service controls module. I'll put it in the chat.
Presenter-B: And I'll show you how I'm using it with our SMB Cloud Foundation, the Cloud Foundation that everyone's familiar with this one. So recently as part of a client project, we deployed this foundation for a client but they had one caveat, They wanted to add perimeters. So we added the new folder Dash 8-8, where we define the perimeters. I prefer to add them towards the end. Once you have your projects, your folder's created Same thing, it helps you out. When you're removing VPC service,
Presenter-B:  To create an access level, there is a module called Access Level where you can specify your IP, subnetworks your users, and identities your regions. Basically anything that we did Under here. Next up, we can create the perimeter. There's a module for that and that module is specify your resources that you want to protect. So your services, your VPC networks, any restricted services that you want to protect in that perimeter and access levels. And then within that, you can specify your ingress policies as well as your ingress policies. But look. It ingress policies in terraform. They're basically JSON but instead of columns you're using equal signs to remember, don't do something like this.
Presenter-B:  Because it'll break your policy. Will not work, it'll break it. Make sure you're using the equal signs. You know, your sources here, you can specify your excess levels your resources. So the same thing that we, you know, when we created the perimeter, you know, when you created your ingress policies, that's where you can specify your identities or identity types. then you have your two stands out, where you specify which APIs. These resources, this these identities and these Resources can talk to. With egress policies, same thing, you know, what access, you know, what, service accounts can talk to the outside of the perimeter. So in this case, and I have a couple Service accounts that I'm selected. That can talk to these APIs outside.
Presenter-B:  So, now I'm gonna run this terraform plan. It's gonna run. It's going to show us that it's going to create perimeters ingress rules. I'm just going to apply this now and we'll do the review. Once it's applied, we like to live dangerously here.
Presenter-B:  Now, there's already an access policy, interesting. Default Policy, Let's delete the default policy. Not sure why it's in here and policies.
01:10:00
Presenter-B:  It's interesting.
Presenter-B:  And of course, I have to run into an issue, right? During my day, let's see here.
Presenter-B: I guess, let's Interest of Time, Let's just disable this resource.
Jimmy Cui:  So, how to run the initialization?
Presenter-B:  You. I don't think I should do a considering, I've Rent this multiple times before and I didn't change any modules underneath. Yeah, I'm not sure what created this policy. Can actually specify it is by name. Let's
Presenter-B:  Yeah.
Presenter-B:  Appellate your sex is Context Manager.
Presenter-B:  I'll see.
Presenter-B: Area.
Presenter-B:  Okay.
Presenter-B: Here. Yeah.
Presenter-B:  not sure why it wouldn't let me do it through my console pot. It's not a problem. It could be because of my cloud identity. I'm using my Sarah identity on A Organization, that's outside of Salah anyway. Plan.
Presenter-B:  Okay.
Presenter-B: Back.
Presenter-B:  That's a good sign.
Jimmy Cui: Yeah.
Presenter-B:  All right. Let's go back to our rumors. You'll see that in here.
Presenter-B:  Wrong window.
Presenter-B:  There we go. I've created two power. Two parameters. I have one protective perimeter where I've specified a bunch of projects, a bunch of VPC networks couple restricted services. And a couple ingress rules that basically allow any access from my access level. So, you know, my IP address. You know, let's say Jimmy if you want to this organization since you're not part of the access level, you would not be able to browse any of the Bigquery tables or cloud storage buckets. Within these projects.
Presenter-B:  In an egress rule. Basically, I'm allowing any identity to, you know, move data outside of this perimeter. Protected, sorry, wrong perimeter. And they have another perimeter with just one project and one VPC, But I have an ingress role where I allow a bunch of identities to access these resources. so, you know, my username or like my terraform service account or like these service accounts will be able to Go to. This perimeter and pull up these resources. So let's say, you know, I go to clouds storage. Under. Protected projects.
Presenter-B:  and here, you know, I can view my buckets since I there is an English rule that allows access cool. Any questions so far, any concerns any thoughts? Anything else that you wanted to see or play around within this demo?
01:15:00
Jimmy Cui: Yeah. Josh
Presenter-B:  Hey, George.
George Alonge: Thanks Mike. My question is the access context manager, can the IPS be private IPS? So here's the use case. Like, if I have a VPN connection to my GCP, um, GCP project, right? And then I walk and then I want to limit access within that within that connection. Are two particularly users.
Presenter-B: So excess control sorry access levels they only work with public iPS but VPN connectivity is supported. You can actually enable private Google access for on-premises networks as well by routes and route advertisements to through that VPN. So, basically, you know, you have your VPN between your GCP organization and your on-premises. In dead VPN, you would specify a route to the private Google access, which would extend your Perimeters or, you know, your access your perimeters to an outside. Network within Access Levels. I think you build believe it, you'll only specify your vpn's public. Gateway.
Presenter-B:  And then, you know, you're allowing access to ingress rules where you can specify, you know what networks can go through there as well. And what identities you just use routes? At this point to advertise that network out there. Yeah.
George Alonge: Oh, I see. Oh, because I had, we had a situation recently where we are configured the VPN connection and we did set up the VPN gateway on VPC service controls but then it wasn't working with the VPN connection. So, but I think what you said about the private Google access is that is that like an additional configuration that we need to do. Allow to allow that to work.
Presenter-B: Yes.
Presenter-B: yeah, I've pasted it in the chat as well and I believe, they also had a page on actually on-prem access to
Presenter-B:  Oh, from outside of a perimeter.
Presenter-B: Yeah, you should be able to I was just out personally, outlab it out in my org to see you like, What components and what gushes you're gonna run into. I personally haven't done it but I I've allowed only like my workstation X is not VPN, but it should be supported because I've seen it reference in their docs a few times.
Presenter-B: Yeah, make sure that you have Club VPN tunnel connection to support. Yeah, so it seems like it's supported it just threw me some gaches that, you know, we have to let it out.
George Alonge: Thanks.
Jimmy Cui: Yeah, I have two questions Mark, let's say I'm a super user for one organization…
Presenter-B: Yeah.
Jimmy Cui: but still, I want to restrict my access to one production GCS bucket.
Presenter-B:  Yeah.
Jimmy Cui: So you are saying, I have to add explicit denying row of policy. To do that.
Presenter-B: No, you shouldn't. So let's say you want to protect your bucket, you put it in a project that you want to protect and you specify. Cloud storage that you want to protect. And once it's in the perimeter,…
Jimmy Cui:  Yeah.
Presenter-B: Anything inside of the perimeter will not be able to talk to cloud storage outside of the perimeter. And nothing from the outside of the perimeter, will be able to talk to the cloud storage bucket. In that perimeter. You'll then have to add ingress and egress rules to allow data transfer from in, or out to the perimeter.
Jimmy Cui:  so, my question is, Should we set up some explicit deny or by default? It is denied.
Presenter-B:  It by default, it is denied. Once you protect the service, Yeah.
Jimmy Cui: Oh okay. That's why you're enable this protection. Is denied,…
Presenter-B: Yes. Yeah,…
Jimmy Cui: okay. Unless you add some ingress right along.
Presenter-B: and it's it's an yeah. Correct. Yeah and it's an opt-in service. So if you don't specify a service in here, It'll be in a wide open. so, in order to deny,…
Jimmy Cui:  Mm-hmm.
Presenter-B: you have to edit to restricted services,
Jimmy Cui:  Yep. Oh, second question. Um, you know, we can restrict access By IP by whatever. You know the resources say you are using the jambox. What if we allow the access from the GEM box? We deny access from your local IP.
01:20:00
Presenter-B: Oh yeah, that's entirely possible. Here's how I do. I create an yeah,…
Jimmy Cui:  I mean, you know,
Presenter-B: it's it's possible. So basically. you don't in ingress rule, you'll specify, you know, the project or a VPC network or you know identity Where that jump box is running. but you won't specify an access level, for example, in this case,
